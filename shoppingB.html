<!-- 説明あり / 割引なし -->
<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>selectshop Chom</title>
    <link rel="stylesheet" href="shoppingStyles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans&display=swap" rel="stylesheet">


    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">

    <!-- Swiper JS -->
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

</head>

<body>
    <!--  トップ画像 -->
    <!-- Swiper container -->
    <div class="swiper-container">
        <!-- Additional required wrapper -->
        <div class="swiper-wrapper">
            <!-- Slides -->
            <div class="swiper-slide"><img src="images/topA.png" alt="Image 1"></div>
            <div class="swiper-slide"><img src="images/topC.png" alt="Image 3"></div>
            <div class="swiper-slide"><img src="images/topD.png" alt="Image 4"></div>
            <!-- ... -->
        </div>
        <!-- If we need pagination -->
        <div class="swiper-pagination"></div>
    </div>

    <h2> New Arrivals</h2>

    <!-- B/Dにだけかく -->
    <div class="popText">
        <img src="/images/ligjt.png" alt="">
        <p>商品画像タップで詳細が見れます</p>
    </div>

    <div class="parent-of-products">
        <div class="products">

            <!-- ワイシャツ -->
            <h2>-shirts-</h2>
            <div class="product">
                <img src="images/products/shirts1.png" alt="シャツ1" class="productImg">
                <div class="product-name">シャツ-グレー-</div>
                <p class="product-description" style="display: none;">エレガントなシルエットで、プロフェッショナルな印象を与えます。</p>
                <div class="product-price">¥3200</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/shirts2.png" alt="シャツ1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">クラシックシャツ①</div>
                <p class="product-description" style="display: none;">このクラシックなデザインは、どんなオフィススタイルにもぴったりです。サステナブルな素材で作られたあなたの毎日を支える一品。</p>
                <div class="product-price">¥4200</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/shirts3.png" alt="シャツ1" class="productImg">
                <div class="product-name">襟付きシャツ</div>
                <p class="product-description" style="display: none;">洗練されたディテールが際立つ、ビジネスカジュアルの定番。</p>
                <div class="product-price">¥3600</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/shirts4.png" alt="シャツ1" class="productImg">
                <div class="product-name">シャツ①</div>
                <p class="product-description" style="display: none;">シンプルながらも洗練されたデザインで、あらゆるビジネスシーンに適しています。</p>
                <div class="product-price">¥3600</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/shirts5.png" alt="シャツ1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">シャツ②</div>
                <p class="product-description" style="display: none;">モダンなカットで、スタイリッシュな印象を演出します。サステナブルな素材で作られたあなたの毎日を支える一品。</p>
                <div class="product-price">¥4200</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>

            <!-- セーター -->
            <h2>-Sweaters-</h2>
            <div class="product">
                <img src="images/products/sweater1.png" alt="セーター1" class="productImg">
                <div class="product-name">グレーセーター</div>
                <p class="product-description" style="display: none;">この暖かく柔らかなセーターは、寒い日にぴったりの選択です。</p>
                <div class="product-price">¥6400</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/sweater2.png" alt="セーター1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">パープルセーター</div>
                <p class="product-description" style="display: none;">鮮やかなパープルが華やかさを添える、快適な着心地のセーターです。長持ちするウール素材を使っており、持続可能なファッションを実現します。</p>
                <div class="product-price">¥7200</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/sweater3.png" alt="セーター1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">ハイネックブラック</div>
                <p class="product-description" style="display: none;">何にでも合わせられる、スリムなシルエットのハイネック。長持ちするウール素材を使っており、持続可能なファッションを実現します。</p>
                <div class="product-price">¥4200</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/sweater4.png" alt="セーター1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">Ｖネックセーター</div>
                <p class="product-description" style="display: none;">どんな装いにも合わせやすいVネックのクラシックセーター。長持ちするウール素材を使っており、持続可能なファッションを実現します。</p>
                <div class="product-price">¥5600</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/sweater5.png" alt="セーター1" class="productImg">
                <div class="product-name">スカイブルーセーター</div>
                <p class="product-description" style="display: none;">明るいスカイブルーが気分をリフレッシュさせる、カジュアルなルックのセーター。</p>
                <div class="product-price">¥6400</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/sweater6.png" alt="セーター1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">淡いピンクセーター</div>
                <p class="product-description" style="display: none;">柔らかなピンク色が特徴的な、リラックスした週末にぴったりのセーターです。長持ちするウール素材を使っており、持続可能なファッションを実現します。</p>
                <div class="product-price">¥7200</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>

            <!-- ズボン -->
            <h2>-pants-</h2>
            <div class="product">
                <img src="images/products/ladyBottom1.png" alt="レディースボトム1" class="productImg">
                <div class="product-name">ジーンズ</div>
                <p class="product-description" style="display: none;">リラックスフィットでカジュアルながらも洗練されたデイリースタイルを提供します。</p>
                <div class="product-price">¥5600</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/ladyBottom2.png" alt="レディースボトム1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">ホワイトパンツ</div>
                <p class="product-description" style="display: none;">広がる裾が特徴的で、洗練されたエレガントなシルエットを演出。リサイクル素材からできたサステナブルな一品。</p>
                <div class="product-price">¥5800</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/ladyBottom3.png" alt="レディースボトム1" class="productImg">
                <div class="product-name">ブラックひだスカート</div>
                <p class="product-description" style="display: none;">動き出すたびに揺れるプリーツが、都会的な魅力を加えるスカートです。</p>
                <div class="product-price">¥6400</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/ladyBottom4.png" alt="レディースボトム1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">デニムスカート</div>
                <p class="product-description" style="display: none;">カジュアルながらも女性らしい形のデニムスカートで、どんなトップスとも相性抜群。環境を考慮して選ばれたリサイクルデニムで作られている。</p>
                <div class="product-price">¥6400</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <!-- メンズパンツ-->
            <div class="product">
                <img src="images/products/mensBottom1.png" alt="メンズボトム1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">ホワイトカーゴパンツ</div>
                <p class="product-description" style="display: none;">機能性とスタイルを兼ね備えたカーゴパンツで、アクティブな日々をサポート。リサイクル素材からできたサステナブルな一品。</p>
                <div class="product-price">¥5600</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/mensBottom2.png" alt="メンズボトム1" class="productImg">
                <div class="product-name">カーキカーゴパンツ</div>
                <p class="product-description" style="display: none;">耐久性に優れたカーゴパンツで、アウトドアにも最適です。</p>
                <div class="product-price">¥5200</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/mensBottom3.png" alt="メンズボトム1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">ブラックワイドパンツ</div>
                <p class="product-description" style="display: none;">スタイリッシュでモダンな印象のワイドパンツは、オンでもオフでも活躍します。リサイクル素材からできたサステナブルな一品。</p>
                <div class="product-price">¥5800</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/mensBottom4.png" alt="メンズボトム1" class="productImg">
                <div class="product-name">ホワイトワイドパンツ</div>
                <p class="product-description" style="display: none;">軽やかな素材と落ち着いた色合いで、洗練された印象を与えるワイドパンツ。</p>
                <div class="product-price">¥5200</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>


            <!-- バッグ -->
            <h2>-Bags-</h2>
            <div class="product">
                <img src="images/products/bag1.png" alt="商品画像1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">クリアトートバック</div>
                <p class="product-description" style="display: none;">この再利用プラスティック製トートは、ファッションと機能性を兼ね備え、環境に優しさをプラスするアイテムです。</p>
                <div class="product-price">¥2400</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/bag2.png" alt="商品画像2" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">クリアバックパック</div>
                <p class="product-description" style="display: none;">耐久性のあるリサイクル素材で作られたこのバックパックは、スタイリッシュで実用的、エココンシャスな日常に最適です。</p>
                <div class="product-price">¥5600</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/bag3.png" alt="商品画像2" class="productImg">
                <div class="product-name">シンプルトート</div>
                <p class="product-description" style="display: none;">シンプルで実用的なデザインのトートバッグ、どんなスタイルにもマッチ。</p>
                <div class="product-price">¥2800</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/bag4.png" alt="商品画像2" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">シルバートート</div>
                <p class="product-description" style="display: none;">光を反射するユニークな質感で、日々のワンポイントに。環境への影響を最小限に抑えて作られた一品。</p>
                <div class="product-price">¥7200</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/bag5.png" alt="商品画像2" class="productImg">
                <div class="product-name">PCリュック①</div>
                <p class="product-description" style="display: none;">スタイリッシュながら機能的、ビジネスシーンに最適なバックパック。</p>
                <div class="product-price">¥9600</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/bag6.png" alt="商品画像2" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">PCリュック②</div>
                <p class="product-description" style="display: none;">洗練されたデザインの高級リュック、ビジネスカジュアルの必需品。傘を再利用て作れるこっそり環境にも優しい品。</p>
                <div class="product-price">¥12000</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/bag7.png" alt="商品画像2" class="productImg">
                <div class="product-name">斜めがけケータイバック</div>
                <p class="product-description" style="display: none;">スリムでスタイリッシュ、必要最小限の持ち物に最適なバッグ。</p>
                <div class="product-price">¥2800</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <!-- ネックレス -->
            <h2>-Accessories-</h2>
            <div class="product">
                <img src="images/products/neck1.png" alt="ネックレス1" class="productImg">
                <div class="product-name">ゴールドネックレス①</div>
                <p class="product-description" style="display: none;">繊細なペンダントがエレガントな印象を与えるネックレス。</p>
                <div class="product-price">¥5600</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/neck2.png" alt="ネックレス1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">ゴールドネックレス②</div>
                <p class="product-description" style="display: none;">シンプルで上品、どんな装いにも合うミニマルなデザイン。環境にやさしいエシカルゴールドを使用。</p>
                <div class="product-price">¥7600</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <!-- 指輪 -->
            <div class="product">
                <img src="images/products/ring1.png" alt="リング1" class="productImg">
                <div class="product-name">ゴールドリング①</div>
                <p class="product-description" style="display: none;">ユニークなデザインが指元を飾るエレガントなリング。</p>
                <div class="product-price">¥4200</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/ring2.png" alt="リング1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">ゴールドリング②</div>
                <p class="product-description" style="display: none;">洗練されたシンプルなデザインで日常を格上げ。環境にやさしいエシカルゴールドを使用。</p>
                <div class="product-price">¥5600</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/ring3.png" alt="リング1" class="productImg">
                <img src="images/ecofriendly.png" alt="Mark" class="mark-image"> <!-- eco -->
                <div class="product-name">シルバーリング①</div>
                <p class="product-description" style="display: none;">モダンな印象のシルバーリング、カジュアルな装いにも。環境にやさしいエシカルシルバーを使用。</p>
                <div class="product-price">¥6400</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
            <div class="product">
                <img src="images/products/ring4.png" alt="リング1" class="productImg">
                <div class="product-name">シルバーリング②</div>
                <p class="product-description" style="display: none;">シンプルながらも存在感のあるデザイン、どんなスタイルにも。</p>
                <div class="product-price">¥5600</div>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>

        </div>
    </div>

    <!-- ポップアップ -->
    <div id="product-popup" class="product-popup">
        <div class="product-popup-content">
            <span class="product-popup-close">&times;</span>
            <img src="" id="popup-image" alt="商品画像" class="popup-productImg">
            <div class="popup-product-name" id="popup-name"></div>
            <div class="popup-description" id="popup-product-description"></div>
            <div class="popup-product-price" id="popup-price"></div>
            <!-- <button class="add-to-cart-btn">Add to Cart</button> -->
        </div>
    </div>


</body>

<footer>
    <h2>YOUR CART</h2>
    <div class="carts">
        <div class="cart-items" id="cart-items">
            <!-- ここに選択された商品が追加されます -->
        </div>
        <div class="totalButton">
            <div class="cart-total">
                <h3>合計</h3>
                <span id="yen">¥<span id="total-price">0</span></span>
            </div>
            <button class="finish-shopping">Finish Shopping</button>
        </div>
    </div>

</footer>


<!--　カートに追加java -->
<script>
    let cart = [];
    const maxTotal = 20000; // 設定したい上限金額

    // 商品をカートに表示する関数
    function displayCartItem(item, index) {
        let cartItems = document.getElementById('cart-items');
        let newItem = document.createElement('div');
        newItem.className = "cart-item";
        newItem.setAttribute('data-index', index); // data-index属性を設定
        newItem.innerHTML = `
        <img src="${item.image}" alt="${item.name}" class="cart-item-image">
        <div class="cart-item-name">${item.name}</div>
        <div class="cart-item-price">¥${item.price}</div>
        <button class="remove-item-btn" onclick="removeCartItem(this)">×</button>
    `;
        cartItems.appendChild(newItem);
    }

    // カート内の合計金額を計算・更新する関数
    function updateTotalPrice() {
        let total = cart.reduce((sum, item) => sum + item.price, 0);
        document.getElementById('total-price').innerText = Math.round(total);
    }

    // カートから商品を削除する関数
    function removeCartItem(button) {
        let cartItem = button.closest('.cart-item'); // 最も近い親の.cart-item divを取得
        let index = parseInt(cartItem.getAttribute('data-index')); // data-index属性からインデックスを取得
        cart.splice(index, 1); // カート配列からアイテムを削除
        cartItem.remove(); // DOMからアイテムを削除

        // 残りのアイテムのインデックスを更新
        document.querySelectorAll('.cart-item').forEach((item, newIndex) => {
            item.setAttribute('data-index', newIndex);
        });

        updateTotalPrice(); // 合計金額を更新
    }

    document.addEventListener('DOMContentLoaded', function () {
        let addToCartButtons = document.querySelectorAll('.add-to-cart-btn');

        addToCartButtons.forEach(button => {
            button.addEventListener('click', function () {
                let productDiv = this.parentElement;
                let productName = productDiv.querySelector('.product-name').innerText;
                let productPrice = parseFloat(productDiv.querySelector('.product-price')
                    .innerText.replace('¥', ''));
                let productImage = productDiv.querySelector('img').src;

                // カートに商品情報を追加
                let newItem = {
                    name: productName,
                    price: productPrice,
                    image: productImage
                };
                cart.push(newItem);

                // カートに商品を表示
                displayCartItem(newItem, cart.length - 1);

                // 合計金額を更新
                updateTotalPrice();
            });
        });
    });
</script>

<!-- 買った商品を送る。 -->

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const finishShoppingButton = document.querySelector('.finish-shopping');
        finishShoppingButton.addEventListener('click', sendToSheet);
    });

    function sendToSheet() {

        const currentTotal = parseFloat(document.getElementById('total-price').innerText);
        if (currentTotal > 20000) {
            // 合計金額が上限を超えている場合、アラートを表示し、処理を中断
            alert('合計金額が20000円を超えているため、次のステップに進めません。');
            // ボタンの無効化を解除
            const finishShoppingButton = document.querySelector('.finish-shopping');
            finishShoppingButton.disabled = false;
            return; // ここで関数を終了させる
        }

        //ボタンの無効化
        const finishShoppingButton = document.querySelector('.finish-shopping');
        finishShoppingButton.disabled = true;

        var url =
            'https://script.google.com/macros/s/AKfycbxo9Rb3I5bvtNO8e1k0DJO7TyF22y7Zb-GTwOI4zD7Hp_DMG1mcdV6D3ywyTw5jmf4X/exec';

        var formData = new FormData(); // フォームデータを作成
        const totalAmount = parseFloat(document.getElementById('total-price').innerText);


        var productsInCart = cart.map(item => item.name);
        formData.append('sheetName', window.location.pathname.split("/").pop().replace(".html", ""));
        formData.append('purchases', productsInCart);
        formData.append('totalAmount', totalAmount);
        formData.append('type', 'shopping');


        fetch(url, {
                method: 'POST',
                body: formData, // フォームデータを送信
            })
            .then(response => {
                console.log("Response received:", response);
                return response.text();
            })
            .then(text => {
                console.log("Response body:", text);
                window.location.href = "survey.html"; // 合計金額が20000円以下なら次のページへ移動
            })
            .catch(error => {
                console.error("Fetch error:", error);
                // エラーが発生した場合はボタンの無効化を解除
                finishShoppingButton.disabled = false;
            });
    }
</script>

<!-- トップ画像 -->
<script>
    var swiper = new Swiper('.swiper-container', {
        // 2秒（2000ミリ秒）ごとにスライドを変更
        autoplay: {
            delay: 3000,
        },
        // 他のオプションもこちらに追加できます
        loop: true,
        pagination: {
            el: '.swiper-pagination',
            clickable: true,
        },
        speed: 1000
    });
</script>

<!-- ポップアップ表示 -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const productImages = document.querySelectorAll('.productImg');
        const popup = document.getElementById('product-popup');
        const closeBtn = document.querySelector('.product-popup-close');
        const popupImg = document.getElementById('popup-image');
        const popupName = document.getElementById('popup-name');
        const popupDescription = document.getElementById('popup-product-description');
        const popupPrice = document.getElementById('popup-price');

        productImages.forEach(productImg => {
            productImg.addEventListener('click', function () {
                const parentProduct = productImg.closest('.product');
                const imgSrc = productImg.getAttribute('src');
                const productName = parentProduct.querySelector('.product-name').textContent;
                const productPrice = parentProduct.querySelector('.product-price').textContent;
                const productDescription = parentProduct.querySelector('.product-description')
                    .textContent; // 説明を取得

                popupImg.setAttribute('src', imgSrc);
                popupName.textContent = productName;
                popupPrice.textContent = productPrice;
                popupDescription.textContent = productDescription; 

                popup.style.display = 'block';
            });
        });

        closeBtn.addEventListener('click', function () {
            popup.style.display = 'none';
        });
    });
</script>



</html>