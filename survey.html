<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>アンケートフォーム</title>
    <link rel="stylesheet" href="survey.css">
</head>

<body>
    <div class="survey-container">
        <h1>アンケート入力画面</h1>
        <p>実験参加ありがとうございます。実験参加後のアンケートに最後ご参加ください。</p>

        <form id="survey-form">
            <fieldset>
                <legend>購買行動</legend>
                <label for="shopping-criteria">今回のショッピングサイトで何を重視して商品を選びましたか？（複数選択可）</label><br>
                <input type="checkbox" id="criteria-quality" name="shopping-criteria" value="quality">
                <label for="criteria-quality">品質</label><br>
                <input type="checkbox" id="criteria-price" name="shopping-criteria" value="price">
                <label for="criteria-price">価格</label><br>
                <input type="checkbox" id="criteria-eco" name="shopping-criteria" value="eco-friendly">
                <label for="criteria-eco">環境に優しい</label><br>
                <input type="checkbox" id="criteria-design" name="shopping-criteria" value="design">
                <label for="criteria-design">デザイン</label><br>

                <label for="impact-rating">環境にやさしいマークや割引はあなたの選択にどの程度影響しましたか？</label><br>
                <input type="range" id="impact-rating" name="impact-rating" min="1" max="10">
            </fieldset>

            <fieldset>
                <legend>体験感</legend>
                <label for="site-experience">今回のショッピングサイトの体験を一言で表すと？</label><br>
                <input type="text" id="site-experience" name="site-experience"><br>

                <label for="eco-info-rating">環境にやさしい商品の説明・情報は十分でしたか？</label><br>
                <input type="range" id="eco-info-rating" name="eco-info-rating" min="1" max="10">
            </fieldset>

            <button class="submitSurvey">アンケートを送信</button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // document.getElementById('survey-form').addEventListener('submit', function (event) {
            //     event.preventDefault(); // フォームのデフォルトの送信を防止

            const submitSurveyButton = document.querySelector('.submitSurvey');
            submitSurveyButton.addEventListener('click', sendToSheet);
        });

        function sendToSheet() {
            var url =
                'https://script.google.com/macros/s/AKfycbwPxIILlguR9MGzUKgOqxELzbfm8TM7Yy5gNUDPGTQ5wyD9BnwyCqRBc0g2kigMJfId/exec';

            // フォームデータを取得
            var formData = new FormData(document.getElementById('survey-form'));
            formData.append('type', 'survey')
            console.log(formData);
            // フォームデータをGoogle Apps Scriptに送信
            fetch(url, {
                    method: 'POST',
                    body: formData // フォームデータを送信
                })
                .then(response => {
                    console.log("Response received:", response);
                    return response.text();
                })
                .then(text => {
                    console.log("Response body:", text);
                    window.location.href = "survey.html";
                })
                .catch(error => {
                    console.error("Fetch error:", error);
                });
        }
    </script>


</body>

</html>